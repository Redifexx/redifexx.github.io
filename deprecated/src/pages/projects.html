<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="../../dist/app-bundle.js"></script>
  <script defer src="https://unpkg.com/alpinejs"></script>
  <title>Gio's Portfolio</title>
  <link href="https://fonts.googleapis.com/css2?family=Zalando+Sans+Expanded:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Questrial&display=swap" rel="stylesheet">
  <link rel="icon" type="image/svg+xml" href="./RGL.ico" />
  <link href="../../dist/output.css" rel="stylesheet">
</head>
<body id="fullBody">
    <div
     x-data = "cardGrid()"
        x-init = "loadCards()"
    class="relative min-h-screen flex p-7 bg-center bg-fixed gap-6"> 
        <video autoplay muted loop playsinline
         class="absolute inset-0 w-full h-full object-cover -z-10">
            <source src="../../public/physx.mp4" type="video/mp4" />
        </video>
        <div class="absolute inset-0 bg-black/50 -z-10"></div>

        <div class= "flex flex-col max-w-[15rem] gap-6">
            <div class= "bg-neutral-900/80 max-w-5xl py-10 px-10 rounded-3xl backdrop-blur-xl flex flex-col gap-4"> 
                <h1 class="text-white text-2xl text-shadow-md text-shadow-stone-200 text-left font-bold">Giovanni Perez Colon</h1>
                <div class = "flex flex-row gap-1 font-display justify-between text-shadow-none">
                    <a href="../../index.html" class="btn btn-xs inset-shadow-sm inset-shadow-emerald-50 text-sm rounded-lg">Home</a>
                    <div class="btn btn-xs inset-shadow-sm inset-shadow-emerald-50 text-sm rounded-lg">About</div>
                    <div class="btn btn-xs inset-shadow-sm inset-shadow-emerald-50 text-sm rounded-lg">Contact</div>
                </div>
            </div>

            <div class= "hero bg-neutral-800/70 max-w-5xl py-10 px-10 rounded-3xl backdrop-blur-xl items-start flex flex-col flex-1 gap-4 overflow-y-auto"> 
                <h1 class="text-white text-2xl text-shadow-md text-shadow-stone-200 text-left font-bold">Tags</h1>
                <div class = "flex flex-wrap gap-2 font-display text-shadow-none">
                    <template x-for="(tag, i) in [...tags]" :key="i">
                        <div>
                            <template x-if="getActiveTag(tag)">
                                <button
                                    @click="setActiveTag(tag)"
                                    class="btn btn-sm text-xl bg-emerald-200/70 inset-shadow-sm inset-shadow-teal-900 rounded-lg px-3 whitespace-nowrap"
                                    x-text="tag"
                                >
                                </button>
                            </template>
                            <template x-if="!getActiveTag(tag)">
                                <button
                                    @click="setActiveTag(tag)"
                                    class="btn btn-sm text-xl inset-shadow-sm inset-shadow-teal-900 rounded-lg px-3 whitespace-nowrap"
                                    x-text="tag"
                                >
                                </button>
                            </template>
                        </div>
                    </template>
                </div>
            </div>
        </div>
        
        <div
            class="relative w-full">
            <div class= "bg-neutral-800/70 py-10 px-10 mb-5 rounded-3xl flex flex-row w-full justify-between backdrop-blur-xl">
                <div class = "flex flex-row gap-4">
                    <div class = "flex flex-col self-center">
                        <h1 class="text-white text-xl text-shadow-md text-shadow-stone-200 text-left self-center font-bold">Sort By:</h1>
                        <div class = "flex flex-row justify-between">
                        </div>
                    </div>

                    <template x-if="sortBy == 0">
                        <button 
                            disabled
                            class="btn btn-sm text-xl self-center rounded-lg disabled:text-white"
                        >
                        Date
                        </button>
                    </template>
                     <template x-if="sortBy != 0">
                        <button @click="sortByDate()"
                            class="btn btn-sm text-xl self-center rounded-lg overflow-hidden
                            hover:shadow-[0_0_10px_4px_rgba(255,255,255,0.5)] 
                            transition-all duration-300">
                            Date
                        </button>
                    </template>

                    <template x-if="sortBy == 1">
                        <button disabled class="btn btn-outline btn-primary btn-disabled btn-sm text-xl self-center rounded-lg disabled:text-white overflow-hidden">Name</button>
                    </template>
                     <template x-if="sortBy != 1">
                        <button @click="sortByName()"
                            class="btn btn-sm text-xl self-center rounded-lg overflow-hidden
                            hover:shadow-[0_0_10px_4px_rgba(255,255,255,0.5)] 
                            transition-all duration-300">
                            Name
                        </button>
                    </template>

                    <template x-if="sortBy == 2">
                        <button disabled class="btn btn-outline btn-primary btn-disabled btn-sm text-xl self-center disabled:text-white rounded-lg overflow-hidden">Project Length</button>
                    </template>
                     <template x-if="sortBy != 2">
                        <button @click="sortByLength()"
                            class="btn btn-sm text-xl self-center rounded-lg overflow-hidden
                            hover:shadow-[0_0_10px_4px_rgba(255,255,255,0.5)] 
                            transition-all duration-300">
                            Project Length
                        </button>
                    </template>

                    <template x-if="isAscending == true">
                        <button @click="toggleAsc()"
                        class="btn btn-sm text-xl self-center rounded-lg
                        overflow-hidden hover:shadow-[0_0_10px_4px_rgba(255,255,255,0.5)]
                        transition-all duration-300">
                        ↑
                        </button>
                    </template>
                    <template x-if="isAscending == false">
                        <button @click="toggleAsc()"
                        class="btn btn-sm text-xl self-center rounded-lg
                        overflow-hidden hover:shadow-[0_0_10px_4px_rgba(255,255,255,0.5)]
                        transition-all duration-300">
                        ↓</button>
                    </template>
                </div>
                <h1 class="text-white text-5xl text-shadow-md text-shadow-stone-200 text-right font-bold">Projects</h1>
            </div>
            <div 
                id="card-container"
                x-on:resize.window="resize()"
                style= "height: calc(100vh - var(--spacing) * (51)); scrollbar-width: none;"
                class= "bg-neutral-800/20 py-10 px-10 rounded-3xl backdrop-blur-xl flex flex-col gap-4 overflow-y-auto"
            > 
                <div 
                    x-init="$watch('expanded', value => {
                        const container = document.getElementById('card-container');
                        if (!container) return;
                        if (value !== null) {
                            container.classList.add('scroll-lock');
                        } else {
                            container.classList.remove('scroll-lock');
                        }
                    })"
                    class="grid gap-4 transition-all duration-300 ease-in-out justify-between"
                    style="transition: width 0.3s ease, grid-template-columns 0.3s ease;"
                    :style="`grid-template-columns: repeat(${columns}, minmax(0, 1fr));`"
                >
                    <template x-for="(card, i) in activeCards" :key="i">
                        <div>
                            <button
                                @click="toggleExpand(i); setExpanded(card)"
                                class="card-body fruitger-inset bg-neutral-950/60 rounded-2xl aspect-square flex flex-col gap-0 p-0 overflow-hidden text-left hover:brightness-125 active:scale-95 transition-all duration-300 ease-in-out"
                                :style="`width: ${cardSize}px;`"
                            >
                                <!-- Image takes 3/4 of height -->
                                <div class="w-full h-4/8 overflow-hidden">
                                    <img 
                                        :src="card.thumbnail"
                                        class="w-full h-full object-cover bg-gradient-to-b from-teal-950/80 to-transparent pointer-events-none"
                                    />
                                </div>

                                <!-- Text takes remaining 1/4, scrolls if too long -->
                                <div class="w-full h-4/8 p-5 overflow-hidden text-ellipsis">
                                    <h2 class="card-title text-xl font-bold line-clamp-2" x-text="card.title"></h2>
                                    <p class="text-md pt-5 font-display line-clamp-3" x-text="card.shortDescription"></p>
                                </div>
                            </button>
                        </div>
                    </template>
                </div>
            </div>
            <template x-if="expandedCard !== null">
                <div 
                    id="card-container-overlay"
                    style= "height: calc(100vh - var(--spacing) * 14)"
                    class= "absolute inset-0 bg-neutral-950/20 py-10 px-10 rounded-3xl backdrop-blur-xl flex flex-col h-full gap-6 z-10 "
                    x-show="expanded !== null"
                    x-transition:enter="transition ease-out duration-300"
                    x-transition:enter-start="translate-y-full opacity-0"
                    x-transition:enter-end="translate-y-0 opacity-100"
                    x-transition:leave="transition ease-in duration-200"
                    x-transition:leave-start="translate-y-0 opacity-100"
                    x-transition:leave-end="translate-y-full opacity-0"
                    x-on:after-leave="setExpanded(null)"
                > 
                    <div 
                    class = "overflow-y-auto flex-1"
                    >
                        <h2 class="card-title text-3xl neu-text-shadow justify-center" x-text="expandedCard.title"></h2>

                        <div class="carousel w-full bg-neutral-950/50 rounded-3xl fruitger-inset my-7">
                            <template x-for="(media, i) in expandedCard.media" :key="i">
                                <div :id="'slide' + i" class="carousel-item relative w-full">
                                    <img :src="media" class="rounded-lg object-contain max-h-[50vh] max-w-full mx-auto p-7">
                                    <div 
                                        x-show="expandedCard.media.length > 1"
                                        class="absolute left-5 right-5 top-1/2 flex -translate-y-1/2 transform justify-between"
                                    >
                                        <a :href="'#slide' + ((i - 1 + expandedCard.media.length) % expandedCard.media.length)"
                                        class="btn btn-circle">❮</a>
                                        <a :href="'#slide' + ((i + 1) % expandedCard.media.length)"
                                        class="btn btn-circle">❯</a>
                                    </div>
                                </div>
                            </template>
                        </div>

                        <p class="text-lg" x-text="expandedCard.description0"></p>
                        <p class="text-lg mt-2" x-text="expandedCard.description1"></p>
                    </div>
                    <button class="btn mt-4 rounded-lg justify-self-end bg-neutral-950 fruitger-inset" @click="expanded = null">Close</button>
                </div>  
            </template>
        </div>
    </div>
</body>
</html>